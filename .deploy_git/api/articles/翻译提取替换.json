{"title":"翻译提取替换","slug":"翻译提取替换","date":"2018-08-03T03:02:18.000Z","updated":"2019-11-27T15:26:48.000Z","comments":true,"path":"api/articles/翻译提取替换.json","photos":[],"link":"","excerpt":"提取<br>提取客户端资源文件之前先要用uc-utf8.php转utf-8 把unicode码转成utf-8的日文在提取<br>将要提取文字的文件整合与getFromHtml.sh 放在同目录下1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>#!/bin/bash<br>#sh getFromHtml.sh under the template fold<br>#Change filelist.csv to excel file, and give it to translator<br><br>LANG=C grep -r -n -v '^[[:cntrl:][:print:]]*$' . | grep -v \"using UnityEngine;\" | grep -v svn | grep -v //  | grep -v \\* |  grep -v \"\\&#123;\\*\" |  grep -v \"\\\"Name\\\"\" &gt; ~/lj_2_3_server.csv<br><br>sed -i 's@\\t@ @g' ~/lj_2_3_server.csv<br>sed -i 's@\\([^:]*\\):\\([0-9]*\\):@\\1\\t\\2\\t@' ~/lj_2_3_server.csv<br>点击下载<br>","covers":["A46180F494E722BBE7AB60D25E81DD0B.jpg","326AD4E2572831FEFC87D564932D6106.jpg"],"content":"<ol>\n<li>提取<br>提取客户端资源文件之前先要用uc-utf8.php转utf-8 把unicode码转成utf-8的日文在提取<br>将要提取文字的文件整合与getFromHtml.sh 放在同目录下<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\">#sh getFromHtml.sh under the template fold</span></span><br><span class=\"line\"><span class=\"comment\">#Change filelist.csv to excel file, and give it to translator</span></span><br><span class=\"line\"></span><br><span class=\"line\">LANG=C grep -r -n -v <span class=\"string\">'^[[:cntrl:][:print:]]*$'</span> . | grep -v <span class=\"string\">\"using UnityEngine;\"</span> | grep -v svn | grep -v //  | grep -v \\* |  grep -v <span class=\"string\">\"\\&#123;\\*\"</span> |  grep -v <span class=\"string\">\"\\\"Name\\\"\"</span> &gt; ~/lj_2_3_server.csv</span><br><span class=\"line\"></span><br><span class=\"line\">sed -i <span class=\"string\">'s@\\t@ @g'</span> ~/lj_2_3_server.csv</span><br><span class=\"line\">sed -i <span class=\"string\">'s@\\([^:]*\\):\\([0-9]*\\):@\\1\\t\\2\\t@'</span> ~/lj_2_3_server.csv</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<p><a href=\"/download/getFromHtml.sh\">点击下载</a><br><a id=\"more\"></a></p>\n<p>可以脚本文件内修改输出路径及文件名<br>运行命令提取内容<br>sh getFromHtml</p>\n<p>取出后的excel先在编辑软件里打开编码改成ansi, 否则直接excel打开会乱码<br>在excel内，全选，点击数据-&gt;分列-&gt;分隔符号-&gt;Tab键-&gt;确定。。。。以Tab键分割内容<br>完成后的数据格式如下：(A列为行数，B列为行号，C列为提取的原字符)<br><img src=\"A46180F494E722BBE7AB60D25E81DD0B.jpg\" alt=\"A46180F494E722BBE7AB60D25E81DD0B\"><br>如果有发现提取到不需要翻译的错误的，可直接整行删除。。。<br>提交翻译</p>\n<ol start=\"2\">\n<li>替换<br>翻译后的文件如果为xls，在最后另起一列，用公式=A1&amp;”^”&amp;B1&amp;”^”&amp;C1连接，拖到底，用连接的主要目的是让文件、行、数据之间有个特殊的符号分割<br>^ 这个符号基本见不到所以用这个，将最后列的数据拷贝到sublime，替换”^ “ 为 “^”去掉多余的数据与行之间的一个空格，然后将\\替换为@@@或者奇怪<br>不重复的符号，如果不替换转换会被转换掉，最后将sublime上的代码考到新建的一个txt中另存为utf-8，上传到服务器对应的目录下面，修改<br>changeHtml.sh这个文件中判断中间的分割符号保存，整个文件权限777.</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"comment\">#sh changeHtml.sh  result_file</span></span><br><span class=\"line\"><span class=\"comment\">#result_file' content</span></span><br><span class=\"line\"><span class=\"comment\">#file's path    line_no old_content     new_content</span></span><br><span class=\"line\"></span><br><span class=\"line\">file=<span class=\"variable\">$1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ -z <span class=\"variable\">$file</span> ]</span><br><span class=\"line\"><span class=\"keyword\">then</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"Input result_file\"</span></span><br><span class=\"line\">        <span class=\"built_in\">exit</span></span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"built_in\">read</span> line</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">        IFS=<span class=\"string\">\"^\"</span></span><br><span class=\"line\">        arr=(<span class=\"variable\">$line</span>)</span><br><span class=\"line\">        filename=<span class=\"variable\">$&#123;arr[0]&#125;</span></span><br><span class=\"line\">        line_num=<span class=\"variable\">$&#123;arr[1]&#125;</span></span><br><span class=\"line\">        str_kr=<span class=\"variable\">$&#123;arr[2]&#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> [ <span class=\"variable\">$str_kr</span> ]</span><br><span class=\"line\">        <span class=\"keyword\">then</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$filename</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$line_num</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$str_kr</span></span><br><span class=\"line\"></span><br><span class=\"line\">                sed -i <span class=\"string\">''</span><span class=\"variable\">$line_num</span><span class=\"string\">' c\\'</span><span class=\"variable\">$str_kr</span><span class=\"string\">''</span>  <span class=\"variable\">$filename</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">                <span class=\"built_in\">echo</span> <span class=\"variable\">$line</span></span><br><span class=\"line\">        <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">done</span> &lt; <span class=\"variable\">$file</span></span><br></pre></td></tr></table></figure>\n<p>运行命令替换内容<br>sh changeHtml.sh text.txt </p>\n<p>运行完.asset的文件是没办法替换的，要手动自行替换</p>\n<p>text.txt数据格式如下<br><img src=\"326AD4E2572831FEFC87D564932D6106.jpg\" alt=\"326AD4E2572831FEFC87D564932D6106\"><br><a href=\"/download/changeHtml.sh\">点击下载</a>       </p>\n","categories":[{"name":"脚本工具","slug":"脚本工具","count":1,"path":"api/categories/脚本工具.json"}],"tags":[]}